<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.547">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gazze - Landa - Irisarri">

<title>Trabajo Práctico 2: Metropolis-Hastings</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="informe2md_files/libs/clipboard/clipboard.min.js"></script>
<script src="informe2md_files/libs/quarto-html/quarto.js"></script>
<script src="informe2md_files/libs/quarto-html/popper.min.js"></script>
<script src="informe2md_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="informe2md_files/libs/quarto-html/anchor.min.js"></script>
<link href="informe2md_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="informe2md_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="informe2md_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="informe2md_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="informe2md_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="informe2md_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="informe2md_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenido</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción">Introducción</a></li>
  <li><a href="#objetivo" id="toc-objetivo" class="nav-link" data-scroll-target="#objetivo">Objetivo</a></li>
  <li><a href="#metropolis-hastings-en-1d" id="toc-metropolis-hastings-en-1d" class="nav-link" data-scroll-target="#metropolis-hastings-en-1d">Metropolis Hastings en 1D</a>
  <ul class="collapse">
  <li><a href="#algoritmo-mh-en-1-d" id="toc-algoritmo-mh-en-1-d" class="nav-link" data-scroll-target="#algoritmo-mh-en-1-d">Algoritmo MH en 1 D</a></li>
  </ul></li>
  <li><a href="#distribución-de-kumaraswamy" id="toc-distribución-de-kumaraswamy" class="nav-link" data-scroll-target="#distribución-de-kumaraswamy">Distribución de Kumaraswamy</a>
  <ul class="collapse">
  <li><a href="#conociendo-a-jagdish-kumaraswamy" id="toc-conociendo-a-jagdish-kumaraswamy" class="nav-link" data-scroll-target="#conociendo-a-jagdish-kumaraswamy">Conociendo a Jagdish Kumaraswamy</a></li>
  <li><a href="#mh-para-jagdish" id="toc-mh-para-jagdish" class="nav-link" data-scroll-target="#mh-para-jagdish">MH para Jagdish</a></li>
  <li><a href="#explorando-cadenas" id="toc-explorando-cadenas" class="nav-link" data-scroll-target="#explorando-cadenas">Explorando cadenas</a></li>
  </ul></li>
  <li><a href="#metropolis-hastings-en-2d" id="toc-metropolis-hastings-en-2d" class="nav-link" data-scroll-target="#metropolis-hastings-en-2d">Metropolis-Hastings en 2D</a>
  <ul class="collapse">
  <li><a href="#conociendo-a-mh-en-2d" id="toc-conociendo-a-mh-en-2d" class="nav-link" data-scroll-target="#conociendo-a-mh-en-2d">Conociendo a MH en 2D</a></li>
  </ul></li>
  <li><a href="#función-de-rosenbrock" id="toc-función-de-rosenbrock" class="nav-link" data-scroll-target="#función-de-rosenbrock">Función de Rosenbrock</a>
  <ul class="collapse">
  <li><a href="#conociendo-a-howard-rosenbrock" id="toc-conociendo-a-howard-rosenbrock" class="nav-link" data-scroll-target="#conociendo-a-howard-rosenbrock">Conociendo a Howard Rosenbrock</a></li>
  </ul></li>
  <li><a href="#conclusiones" id="toc-conclusiones" class="nav-link" data-scroll-target="#conclusiones">Conclusiones</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Trabajo Práctico 2: Metropolis-Hastings</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gazze - Landa - Irisarri </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introducción" class="level1">
<h1>Introducción</h1>
<p>Metropolis-Hastings es un proceso para generar muestras pseudoaleatorias de distribuciones objetivo. Se trata de un proceso iterativo que comienza en un punto inicial en el espacio de muestras, luego, propone un “salto” a un nuevo punto utilizando una distribución de probabilidad propuesta. Este salto es evaluado mediante un criterio de aceptación basado en la relación entre la densidad en el nuevo punto y en el punto actual. Si el salto es aceptado, el algoritmo se mueve al nuevo punto, sino, permanece en el punto actual. Este proceso se repite muchas veces para explorar y muestrear de manera eficiente. En este trabajo práctico, se explorará la aplicabilidad y el rendimiento del algoritmo para distintas distribuciones objetivo y propuestas.</p>
</section>
<section id="objetivo" class="level1">
<h1>Objetivo</h1>
<p>Se propone explorar y comprender el funcionamiento y la utilidad del algoritmo de Metropolis-Hastings en diferentes situaciones. Se abordarán ejercicios que van desde la generación de muestras unidimensionales, hasta la aplicación del algoritmo en problemas más complejos como la generación de muestras de una distribución normal bivariada y la estimación de la distribución a posteriori de una funciones de densidad complejas. A través de estos ejercicios, se buscará evaluar el desempeño del algoritmo y comprender sus ventajas y limitaciones en la generación de muestras de distribuciones de probabilidad.</p>
</section>
<section id="metropolis-hastings-en-1d" class="level1">
<h1>Metropolis Hastings en 1D</h1>
<p>Para entrar en calor, se comienza declarando una función que implemente el algoritmo de Metropolis-Hastings para tomar muestras de una distribución de probabilidad unidimensional. El algoritmo permiete elegir entre un punto de inicio arbitrario o al azar y utiliza la distribución propuesta de transición arbitraria (por defecto, se utiliza una distribución normal estándar).</p>
<section id="algoritmo-mh-en-1-d" class="level2">
<h2 class="anchored" data-anchor-id="algoritmo-mh-en-1-d">Algoritmo MH en 1 D</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>d_propuesta_def <span class="ot">&lt;-</span> <span class="cf">function</span>(x, mean){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(x, mean, <span class="at">sd=</span> <span class="dv">1</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: agregar tasa de aceptación a la funcion</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>sample_mh <span class="ot">&lt;-</span> <span class="cf">function</span> (d_objetivo, r_propuesta, <span class="at">d_propuesta =</span> d_propuesta_def, p_inicial, n){</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(n<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  salto <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  muestras <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  muestras[<span class="dv">1</span>]<span class="ot">&lt;-</span>p_inicial</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    p_actual <span class="ot">&lt;-</span> muestras[i<span class="dv">-1</span>]</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    p_nuevo <span class="ot">&lt;-</span> <span class="fu">r_propuesta</span>(p_actual)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    f_actual <span class="ot">&lt;-</span> <span class="fu">d_objetivo</span>(p_actual)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    f_nuevo <span class="ot">&lt;-</span> <span class="fu">d_objetivo</span>(p_nuevo)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    q_actual <span class="ot">&lt;-</span> <span class="fu">d_propuesta</span>(p_actual,<span class="at">mean=</span>p_nuevo)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    q_nuevo <span class="ot">&lt;-</span> <span class="fu">d_propuesta</span>(p_nuevo,<span class="at">mean=</span>p_actual)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>, (f_nuevo<span class="sc">/</span>f_actual)<span class="sc">*</span>(q_actual<span class="sc">/</span>q_nuevo))</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    aceptar <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">1</span>, alpha)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (aceptar){</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>      muestras[i] <span class="ot">&lt;-</span> p_nuevo</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>      salto <span class="ot">=</span> salto <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># </span><span class="al">TODO</span><span class="co">: agregar tasa de aceptación a la funcion</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>      muestras[i] <span class="ot">&lt;-</span> p_actual</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  tasa_acepta <span class="ot">=</span> (salto<span class="sc">/</span>n)<span class="sc">*</span><span class="dv">100</span><span class="co"># </span><span class="al">TODO</span><span class="co">: agregar tasa de aceptación a la funcion</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print( tasa_acepta)</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> ( muestras ) </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="distribución-de-kumaraswamy" class="level1">
<h1>Distribución de Kumaraswamy</h1>
<p>La distribución de Kumaraswamy es una distribución de probabilidad continua que se utiliza para modelar variables aleatorias con soporte en el intervalo <span class="math inline">\((0;1)\)</span>.</p>
<section id="conociendo-a-jagdish-kumaraswamy" class="level2">
<h2 class="anchored" data-anchor-id="conociendo-a-jagdish-kumaraswamy">Conociendo a Jagdish Kumaraswamy</h2>
<p>Se grafica la función de densidad de la distribución de Kumaraswamy para 5 combinaciones de los parámetros <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> con el objetivo de familiarizarse con su comportamiento.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>d_kumaraswamy <span class="ot">&lt;-</span> <span class="cf">function</span>(x, a ,b){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(x<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">||</span> x<span class="sc">&gt;</span><span class="dv">1</span>){</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    f<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    f <span class="ot">&lt;-</span> a<span class="sc">*</span>b<span class="sc">*</span>(x<span class="sc">^</span>(a<span class="dv">-1</span>))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span>a)<span class="sc">^</span>(b<span class="dv">-1</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(f)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="informe2md_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La distribución de Kumaraswamy resulta muy útil a la hora de realizar estudios bayesianos, ya que presenta una es gran flexibilidad y puede modelar una amplia gama de formas de distribución de probabilidad. Ademas presenta una función de densidad de probabilidad simple y computacionalmente eficiente, lo que facilita su uso en cálculos bayesianos. Por último, vale destacar que la restricción al intervalo <span class="math inline">\((0;1)\)</span> resulta útil porque se adapta naturalmente al modelado de proporciones y probabilidades.</p>
</section>
<section id="mh-para-jagdish" class="level2">
<h2 class="anchored" data-anchor-id="mh-para-jagdish">MH para Jagdish</h2>
<p>Se utiliza la función construida en el punto 1, obtenga 5000 muestras de una distribución de Kumaraswamy con parámetros <span class="math inline">\(a=6 , b=2\)</span> y una distribución de propuesta beta.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>get_beta_pars <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, kappa){</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> mu <span class="sc">*</span>kappa</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>mu)<span class="sc">*</span>kappa</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#graficar kumaraswamy 6 2, y una beta 8,2 para mostrar que son parecidas</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>d_objetivo <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">a=</span><span class="dv">6</span> ,<span class="at">b=</span><span class="dv">2</span>){</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(x<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">||</span> x<span class="sc">&gt;</span><span class="dv">1</span>){</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    f<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    f <span class="ot">&lt;-</span> a<span class="sc">*</span>b<span class="sc">*</span>(x<span class="sc">^</span>(a<span class="dv">-1</span>))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span>a)<span class="sc">^</span>(b<span class="dv">-1</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(f)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se observan las cadenas obtenidas utilizando tres grados de concentración distintos <span class="math inline">\(kappas = 1\)</span>, <span class="math inline">\(25\)</span> y <span class="math inline">\(50\)</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="informe2md_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="informe2md_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>calcular_w <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">apply</span>(x, <span class="dv">2</span>, var))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>calcular_b <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  media_chain <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>, mean)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span>(media_chain) <span class="sc">*</span> <span class="fu">nrow</span>(x)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>R_hat <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="fu">ncol</span>(x)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">calcular_w</span>(x)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">calcular_b</span>(x)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  numerador <span class="ot">&lt;-</span> (S<span class="dv">-1</span>)<span class="sc">/</span>S <span class="sc">*</span> W <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> S) <span class="sc">*</span> B</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(numerador <span class="sc">/</span> W)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>corr <span class="ot">&lt;-</span> <span class="fu">acf</span>(muestras[,<span class="dv">3</span>], <span class="at">plot =</span> <span class="cn">FALSE</span>, <span class="at">lag =</span> <span class="cn">Inf</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>N_eff <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  n_eff <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">ncol</span>(x))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(x)) {</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    S <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    autocorr <span class="ot">&lt;-</span> <span class="fu">acf</span>(x[,i], <span class="at">plot =</span> <span class="cn">FALSE</span>, <span class="at">lag =</span> <span class="cn">Inf</span>)<span class="sc">$</span>acf</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    limite <span class="ot">&lt;-</span> <span class="fu">which</span>(autocorr<span class="sc">&lt;</span><span class="fl">0.05</span>)[<span class="dv">1</span>]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    denominador <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(autocorr[<span class="dv">2</span><span class="sc">:</span>limite])</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    n_eff[i] <span class="ot">&lt;-</span> S <span class="sc">/</span> denominador  </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(n_eff)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="informe2md_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Lo primero que se puede mencionar es la diferencia en las tasas de aceptación, las cuales fueron <span class="math inline">\(21.72\)</span> %, <span class="math inline">\(77.9\)</span>% y <span class="math inline">\(81.66\)</span>% y los números efectivos de muestras <span class="math inline">\(522.36\)</span>, <span class="math inline">\(345.08\)</span> y <span class="math inline">\(133.14\)</span> respectivamente. En cuanto a los recorridos de las muestras, se observa aleatoridad o un patrón de <em>ruido blanco</em>. Finalmente observamos el <span class="math inline">\(\hat{R}\)</span> el cual resultó ser <span class="math inline">\(1.003404\)</span> lo que nos indica converngencia entren cadenas. Tambien, se presentan histogramas de frecuencias observadas para las distintas muestras y se obaservan comportamientos similares para las tres concentraciones elegidas.</p>
</section>
<section id="explorando-cadenas" class="level2">
<h2 class="anchored" data-anchor-id="explorando-cadenas">Explorando cadenas</h2>
<p>Se presenta una tabla con la media de la distribución y los percentiles 5 y 95 de cada una de las cadenas obtenidas</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;"></th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">Medias</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">Percentil 5</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">Percentil 95</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Kappa = 1</td>
<td style="text-align: right;">0.791</td>
<td style="text-align: right;">0.550</td>
<td style="text-align: right;">0.969</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kappa = 25</td>
<td style="text-align: right;">0.796</td>
<td style="text-align: right;">0.543</td>
<td style="text-align: right;">0.962</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kappa = 50</td>
<td style="text-align: right;">0.771</td>
<td style="text-align: right;">0.506</td>
<td style="text-align: right;">0.948</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Se replica la misma tabla para el <span class="math inline">\(logit(x)\)</span> de las muestras.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;"></th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">Medias</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">Percentil 5</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">Percentil 95</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Kappa = 1</td>
<td style="text-align: right;">1.556</td>
<td style="text-align: right;">0.200</td>
<td style="text-align: right;">3.435</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kappa = 25</td>
<td style="text-align: right;">1.590</td>
<td style="text-align: right;">0.172</td>
<td style="text-align: right;">3.234</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kappa = 50</td>
<td style="text-align: right;">1.402</td>
<td style="text-align: right;">0.024</td>
<td style="text-align: right;">2.911</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="metropolis-hastings-en-2d" class="level1">
<h1>Metropolis-Hastings en 2D</h1>
<p>Para extender el algoritmo de Metropolis-Hastings se generaliza la función permitiendole implementar el proceso para más de una dimensión. Se plantea una probabilidad de salto normal bivariada de matriz de covarianza variable y se otorga flexibilidad al algoritmo haciendo que reciba como argumento la matriz de covarianza de la probabilidad de transición.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sample_mh_2d <span class="ot">&lt;-</span> <span class="cf">function</span> (d_objetivo, r_propuesta, d_propuesta, p_inicial, n, sigma_prop){</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(n<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  salto <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  muestras <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n, <span class="at">ncol =</span> <span class="fu">length</span>(p_inicial))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  muestras[<span class="dv">1</span>,]<span class="ot">&lt;-</span>p_inicial</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    p_actual <span class="ot">&lt;-</span> muestras[i<span class="dv">-1</span>,]</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    p_nuevo <span class="ot">&lt;-</span> <span class="fu">r_propuesta</span>(p_actual)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    f_actual <span class="ot">&lt;-</span> <span class="fu">d_objetivo</span>(p_actual)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    f_nuevo <span class="ot">&lt;-</span> <span class="fu">d_objetivo</span>(p_nuevo)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    q_actual <span class="ot">&lt;-</span> <span class="fu">d_propuesta</span>(p_actual,<span class="at">mean=</span>p_nuevo)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    q_nuevo <span class="ot">&lt;-</span> <span class="fu">d_propuesta</span>(p_nuevo,<span class="at">mean=</span>p_actual)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>, (f_nuevo<span class="sc">/</span>f_actual)<span class="sc">*</span>(q_actual<span class="sc">/</span>q_nuevo))</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    aceptar <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">1</span>, alpha)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (aceptar){</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>      muestras[i,] <span class="ot">&lt;-</span> p_nuevo</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>      salto <span class="ot">=</span> salto <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>      muestras[i,] <span class="ot">&lt;-</span> p_actual</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  tasa_acepta <span class="ot">&lt;-</span> (salto<span class="sc">/</span>n)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print(tasa_acepta)</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> ( muestras ) </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="conociendo-a-mh-en-2d" class="level2">
<h2 class="anchored" data-anchor-id="conociendo-a-mh-en-2d">Conociendo a MH en 2D</h2>
<p>Para comenzar a explorar el comportamiento del algoritmo en dos dimensiones se obtendran muestras de una distribución normal bivariada con media <span class="math display">\[ \mu = \begin{pmatrix}
   0.4 \\
   0.75
\end{pmatrix} \]</span> y matriz de covarianza <span class="math display">\[\Sigma=\begin{pmatrix}
   0.35 &amp; 0.4 \\
   0.4 &amp; 2.4
\end{pmatrix} \]</span></p>
<p>Se comienza graficando la distribución objetivo para seleccionar un punto inicial contenido en el recorrido de la misma.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="informe2md_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="informe2md_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Luego se utiliza la función <strong>sample_mh_2d</strong> para obtener cinco mil muestras de esta distribución y se grafican.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="informe2md_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>plot_trace <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">2</span>), <span class="at">y =</span> <span class="fu">c</span>(x, y), <span class="at">dimension =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">each =</span> n))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(df)<span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">color =</span> <span class="st">"#536C8D"</span>)<span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(dimension))<span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Número de Muestra"</span>, <span class="at">y =</span> <span class="st">"Valor"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_trace</span>(muestras_2d_df<span class="sc">$</span>V1, muestras_2d_df<span class="sc">$</span>V2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="informe2md_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Se observa nuevamente un patrón de <em>ruido blanco</em> en los Trace Plot, lo cual indica una mustra poco correlacionada a través de las observaciones. Mientras que el número efectivo de muestras para <span class="math inline">\(X_1\)</span> es igual a <span class="math inline">\(481.98\)</span> y para <span class="math inline">\(X_2\)</span> resulta <span class="math inline">\(363.31\)</span>, lo cual indica que nuestras cinco mil muestras correlacionadas equivalen a cuatrocientas ochenta y dos y trecientas secenta y tres muestras independientes, respectivamente.</p>
<p>A fines de comparar la calidad de las muestras obtenidas, se calculan y comparan algunas probabilidades mediante distitntos metodos.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;"></th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">Muestras</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">Montecarlo</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">Grilla</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">Prob. Exacta</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">P(X1&gt; 1, X2&lt; 0)</td>
<td style="text-align: right;">0.0748</td>
<td style="text-align: right;">0.0736</td>
<td style="text-align: right;">0.0691</td>
<td style="text-align: right;">0.0683</td>
</tr>
<tr class="even">
<td style="text-align: left;">P(X1&gt; 1, X2&gt; 2)</td>
<td style="text-align: right;">0.0814</td>
<td style="text-align: right;">0.0850</td>
<td style="text-align: right;">0.0762</td>
<td style="text-align: right;">0.0870</td>
</tr>
<tr class="odd">
<td style="text-align: left;">P(X1&gt; 0.4, X2&gt; 0.75)</td>
<td style="text-align: right;">0.2734</td>
<td style="text-align: right;">0.2816</td>
<td style="text-align: right;">0.2775</td>
<td style="text-align: right;">0.2857</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Como se observa en la tabla, si bien las probabilidades obtenidas mediante el metodo de Monte Carlo son las que más se aproximan a las reales, con el método de Metropolis Hasting se obtienen muy buenas aproximaciones. Vale aclarar que en situaciones más complejas, donde se dificulta el calculo de las probabilidades exactas, la aplicación de MH toma mayor importancia.</p>
</section>
</section>
<section id="función-de-rosenbrock" class="level1">
<h1>Función de Rosenbrock</h1>
<p>La función de Rosenbrock, comunmente conocida como la “banana de Rosenbrock”, es una función matemática utilizada frecuentemente como un problema de optimización y prueba para algoritmos de optimización numérica. También es muy conocida en el campo de la estadística bayesiana, ya que en ciertos escenarios, la densidad del posterior toma una forma que definitivamente se asemeja a la banana de Howard Rosenbrock.</p>
<p>Un ejemplo de esto se presenta a continuación: <span class="math display">\[p^*(x_1, x_2 \mid a, b) = \exp \left\{-\left[(a - x_1) ^ 2 + b(x_2 - x_1^2) ^ 2\right] \right\}\]</span></p>
<section id="conociendo-a-howard-rosenbrock" class="level2">
<h2 class="anchored" data-anchor-id="conociendo-a-howard-rosenbrock">Conociendo a Howard Rosenbrock</h2>
<p>El objetivo en este tramo del trabajo es obtener muestras de dicha función utilizando el algoritmo de Metropolis Hasting, para esto, se comienza graficandola para conocer su recorrido y asi poder seleccionar un punto inicial.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="informe2md_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="informe2md_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Se obtienen muestras utilizando tres matrices de covariancias distintas para la distribución que propone los saltos. Estas son: <span class="math display">\[\Sigma_1=\begin{pmatrix}
   4 &amp; 1 \\
   1 &amp; 4
\end{pmatrix} \]</span> Las muestras del primer postirior resultan de la forma</p>
<p><span class="math display">\[\Sigma_2=\begin{pmatrix}
   1 &amp; 0 \\
   0 &amp; 1
\end{pmatrix} \]</span> Las muestrar del segundo postirior obtenida resultan de la forma</p>
<p><span class="math display">\[\Sigma_3=\begin{pmatrix}
   2 &amp; -2 \\
   -2 &amp; 5
\end{pmatrix} \]</span> Las muestrar del tercer postirior obtenida resultan de la forma</p>
<p>Se comparan las trayectorias para las distintas muestras obtenidas, y posteriormente se analizan las funciones de autocorrelación:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="informe2md_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Se observa que la trayectoria de la primera y tercera muestra parecen presentar valores en todo el recorrido de la función de Rosenbrock, mientras que la muestra obtenida con la segunda cadena se restringe a los valores centrales de dicha función.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="informe2md_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="informe2md_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;"></th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">$N_{eff}\ para\ X_1$</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">$N_{eff}\ para\ X_2$</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Muestra 1</td>
<td style="text-align: right;">218.43</td>
<td style="text-align: right;">113.38</td>
</tr>
<tr class="even">
<td style="text-align: left;">Muestra 2</td>
<td style="text-align: right;">185.14</td>
<td style="text-align: right;">214.42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Muestra 3</td>
<td style="text-align: right;">98.23</td>
<td style="text-align: right;">92.24</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>A diferencia de las muestras 1 y 2, la tercera muestra presenta una mayor autocorrelación en sus observaciones, y debido a esto se puede observar que también el número efectivo de muestras disminuye en prácticamente la mitad de las observaciones. Esto podría deberse a que la matriz de covarianza utilizada en esta cadena no acompaña la forma de la distribución a posteriori.</p>
<p>Nuevamente, con el motivo de analizar la calidad de las muestras obtenidas, se calculan y comparan algunas probabilidades mediante dichas muestras y el método de la grilla.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;"></th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">Muestras</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">Montecarlo</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">Grilla</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: black !important; background-color: rgba(97, 56, 96, 255) !important;">Prob. Exacta</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">P(0&lt; X1 &lt;1 ; 0&lt; X2 &lt;1)</td>
<td style="text-align: right;">0.3896</td>
<td style="text-align: right;">0.5164</td>
<td style="text-align: right;">0.3697</td>
<td style="text-align: right;">0.5137</td>
</tr>
<tr class="even">
<td style="text-align: left;">P(-1&lt; X1 &lt;0 ; 0&lt; X2 &lt;1)</td>
<td style="text-align: right;">0.1478</td>
<td style="text-align: right;">0.2041</td>
<td style="text-align: right;">0.1444</td>
<td style="text-align: right;">0.2022</td>
</tr>
<tr class="odd">
<td style="text-align: left;">P(1&lt; X1 &lt;2 ; 2&lt; X2 &lt;3)</td>
<td style="text-align: right;">0.0298</td>
<td style="text-align: right;">0.0872</td>
<td style="text-align: right;">0.0605</td>
<td style="text-align: right;">0.0838</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Estos resultados exponen una debilidad en el algoritmo de Metropolis Hasting. Se observan importantes diferencias entre las probabilidades calculadas con MH o grilla en comparación a las probabilidades calculadas con Monte Carlo o integración exacta (estos últimos dos metodos, más precisos).</p>
</section>
</section>
<section id="conclusiones" class="level1">
<h1>Conclusiones</h1>
<p>A lo largo del trabajo, se observa que Metropolis Hastings es una variante que permite sacar muestras de distribuciones de probabilidad, incluso cuando no se tiene idea de cómo es exactamente esa distribución, solo se necesita su ley. Se ha probado en distribuciones unidimensionales y bidimensionales, como las distribuciones de Kumaraswamy y Rosenbrock. Se ha interactuado con diferentes formas de distribución propuesta y se ha observado cómo esta afecta a la eficiencia del algoritmo. Sin embargo, se han identificado algunas debilidades, por ejemplo, su rendimiento puede ser sensible a la elección de la distribución propuesta, lo que puede afectar la eficiencia y la convergencia del algoritmo. Además, puede ser computacionalmente costoso para dimensiones muy altas o distribuciones multimodales.</p>
<p>Es interesante ver a Metropolis Hastings como una herramienta en estadística bayesiana, ya que ayuda a muestrear y/o graficar distribuciones a posteriori. No obstante, se conocen métodos más precisos para obtener muestras de distribuciones complejas, como por ejemplo, Hamiltonian - Monte Carlo.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>