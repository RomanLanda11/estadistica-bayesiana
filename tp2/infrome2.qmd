---
title: "tp2_informe"
author: "Gazze - Landa - Irisarri"
format: html
editor: visual
---

# Metropolis Hastings en 1D

```{r}
sample_mh <- function (d_objetivo, r_propuesta, 
                       d_propuesta = function(x, mean) dnorm(x, mean=mean, sd=0.25), p_inicial, n){
  stopifnot(n>0)
  muestras <- numeric(n)
  muestras[1]<-p_inicial
  for (i in 2:n) {
    p_actual <- muestras[i-1]
    p_nuevo <- r_propuesta(p_actual)
    f_actual <- d_objetivo(p_actual)
    f_nuevo <- d_objetivo(p_nuevo)
    
    q_actual <- d_propuesta(p_actual,mean=p_nuevo)
    q_nuevo <- d_propuesta(p_nuevo,mean=p_actual)
    
    alpha <- min(1, (f_nuevo/f_actual)*(q_actual/q_nuevo))
    
    aceptar <- rbinom(1,1, alpha)
    if (aceptar){
      muestras[i] <- p_nuevo
    } else {
      muestras[i] <- p_actual
    }
    
  }
  return ( muestras ) 
}

d_objetivo <- function(x){
  a=2
  b=5
  if(x<0 || x>1){
    f=0
  }else{
    f <- a*b*(x^(a-1))*(1-x^a)^(b-1)
  }
  return(f)
}
r_propuesta <- function(x) rnorm(1, mean=x, sd=0.25)
d_propuesta <- function(x, mean) dnorm(x, mean=mean, sd=0.25)
p_inicial <- runif()#agregar recorrido en eje x de la d_objetivo
muestras <- sample_mh(d_objetivo, r_propuesta, d_propuesta, p_inicial= p_inicial, n=50000 )

#plot(muestras, type= "l")
#hist(muestras)


```
